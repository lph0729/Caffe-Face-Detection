# 人脸检测项目实战

目的：检测到人脸框

一.数据的获取与裁剪：

    1.数据获取：

        1).benchmark是一个行业的基准(数据库、论文、源码、结果)；

        2).优秀论文，通常实验室阶段都会介绍他们使用的数据集，公开数据集可以下载。申请数据集的时候，最好使用学校的邮箱；

        3).论坛或者交流社区，比如thinkface

        4).数据的规模：越大越好，今天的数据量是4w多

    2.二分类数据：

        第一类是人脸数据：路径(/xx.jpg) 左上角与右下角坐标(68, 80, 280, 320)

            对于正样本：裁剪的操作，根据标注的坐标，将人脸裁剪出来，可以使用opencv这个工具来完成制作人脸数据，要检查一下人脸到底有没有问题

        第二类是非人脸数据: 只要不是人脸都是可以的

            对于负样本：拿原始数据进行随机的裁剪，通过比较在原始数据的IOU这个比例(重叠比例)，当IOU < 0.3时，认为是一个负样本，但是最好是

        拿没有人脸的数据当做负样本

        注解：1).也可以使用IOU > 0.7的人脸数据当做正样本，这样优势是在原始数据的图片出现人脸遮挡，或者光线不足等情况时，模型也可以学这样的样

        本特征，从而提高模型的识别率；

            2).使用原始人脸数据集作为负样本的提取数据，可能会出现因为原始数据中含有多个人脸而标注的的人脸只标注一个，导致制作负样本的时候，

        也可能含有人脸数据的图片。当负样本使用完全没有人脸的新的数据源时，好处是可以避免模型在学习负样本的时候也学到人脸的情况，坏处是模型

        不能学到负样本数据中人脸数据IOU 在0 < IOU < 0.3范围内的特征，从而会降低模型识别的准确率

二.制作LMDB数据源(其实就是caffe支持的非常常用的分类数据源)

    1.写两个txt文档文件

        Train.txt: 0/xxx.jpg 0  1/xxx.jpg 1

        Val.txt: xxx.jpg 0 xxx.jpg 1

    2.制作LMDB数据源，用caffe提供的脚本文件：

        首先需要改一下自己的安装目录

        要进行一个resize操作，比如ALEXNET或者VGG通常都是给它resize 227*227

        执行脚本文件： sh LMDB脚本文件，文件是很大的

三.神经网络：ALEXNET

    需要把最后一层全连接层改成你要分类的类别个数(人脸检测来说就是2)

    solver文件：

        test_iter: 一次测试需要测试多少个batch,最好让 test_iter*batch_size = 测试集中样本总数

        base_lr: 基础学习率，太重要了，不能太大

        网络训练速度与什么相关：

            1).网络的模型大小：网络越大，速度越快

            2).数据输入的大小：227*227 和 32*32，可能要慢几百倍。输入越大，网络越慢














